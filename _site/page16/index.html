<!DOCTYPE html>
<html lang="en">

  <head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <title>
    
      渋谷ではたらくインフラエンジニアのブログ &middot; 
    
  </title>

  <link rel="stylesheet" href="/styles.css">
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/public/apple-touch-icon-precomposed.png">
  <link rel="shortcut icon" href="/public/favicon.ico">
  <link rel="alternate" type="application/atom+xml" title="渋谷ではたらくインフラエンジニアのブログ" href="/atom.xml">
</head>


  <body>

    <div class="container content">
      <header class="masthead">
        <h3 class="masthead-title">
          <a href="/" title="Home">渋谷ではたらくインフラエンジニアのブログ</a>
          <small></small>
        </h3>
      </header>

      <main>
        <div class="posts">
  
  <article class="post">
    <h1 class="post-title">
      <a href="/dev/vjcommentplugin%e3%81%a7%e8%89%b2%e3%80%85%e3%81%af%e3%81%be%e3%82%8b/">
        vjCommentPluginで色々はまる
      </a>
    </h1>

    <time datetime="2010-10-07T11:59:49-07:00" class="post-date">07 Oct 2010</time>

    <div class="wp_social_bookmarking_light">
  <div class="wsbl_hatena_button">
    <a href="http://b.hatena.ne.jp/entry/http://b.l0g.jp/dev/vjcommentplugin%e3%81%a7%e8%89%b2%e3%80%85%e3%81%af%e3%81%be%e3%82%8b/" class="hatena-bookmark-button" data-hatena-bookmark-title="vjCommentPluginで色々はまる" data-hatena-bookmark-layout="standard" title="このエントリーをはてなブックマークに追加"> <img src="//b.hatena.ne.jp/images/entry-button/button-only@2x.png" alt="このエントリーをはてなブックマークに追加" width="20" height="20" style="border: none;" /></a>
  </div>
  
  <div class="wsbl_facebook_like">
    <div id="fb-root">
    </div><fb:like href="http://b.l0g.jp/dev/vjcommentplugin%e3%81%a7%e8%89%b2%e3%80%85%e3%81%af%e3%81%be%e3%82%8b/" layout="button_count" action="like" width="100" share="false" show_faces="false"></fb:like>
  </div>
  
  <div class="wsbl_twitter">
    &lt;a href="https://twitter.com/share" class="twitter-share-button"{count} data-url="http://b.l0g.jp/dev/vjcommentplugin%e3%81%a7%e8%89%b2%e3%80%85%e3%81%af%e3%81%be%e3%82%8b/" data-text="vjCommentPluginで色々はまる" data-via="dblmkt " data-lang="ja"&gt;Tweet
  </div>
  
  <div class="wsbl_google_plus_one">
    <g:plusone size="medium" annotation="none" href="http://b.l0g.jp/dev/vjcommentplugin%e3%81%a7%e8%89%b2%e3%80%85%e3%81%af%e3%81%be%e3%82%8b/"></g:plusone>
  </div>
</div>

<p><br class="wp_social_bookmarking_light_clear" /></p>

<p>symfonyでニュースの記事などにコメント欄を付けるプラグインとして、<a href="http://www.symfony-project.org/plugins/vjCommentPlugin" target="_blank">vjCommentPlugin</a>というのがある。これの設定でちょっとはまったので、メモ。</p>

<p>インストールや設定はReadmeに書いてある通りで、簡単。ログインしないとコメントできないようにするため、sfGuardPluginと連携させる機能が追加されているのだが、これが癖者。この機能を使うときには、app.ymlに以下の表記を追記する。</p>

<blockquote>
  <p>all:</p>
</blockquote>

<blockquote>
  <p>vjCommentPlugin:</p>
</blockquote>

<blockquote>
  <p>guardbind: true</p>
</blockquote>

<blockquote>
  <p>restricted: true</p>
</blockquote>

<p>Readmeには、frontend/config/app.ymlを編集しろと書いてあるのだが、これだとコメントを保存するテーブルの中身が、ログインしないとコメントできないように書き換わってくれない。plugin/vjCommentPlugin/config/app.ymlを上の通り編集する必要がある。</p>

<p>また、この状態で symfony doctrine:build すると、以下のエラーが出る。</p>

<blockquote>
  <p>SQLSTATE[HY000]: General error: 1005 Can’t create table ‘pjtransrate.#sql-15f0_b9’ (errno: 150). Failing Query: “ALTER TABLE comment ADD CONSTRAINT comment_user_id_sf_guard_user_id FOREIGN KEY (user_id) REFERENCES sf_guard_user(id)”. Failing Query: ALTER TABLE comment ADD CONSTRAINT comment_user_id_sf_guard_user_id FOREIGN KEY (user_id) REFERENCES sf_guard_user(id)</p>
</blockquote>

<p>これは、sfGuardUserテーブルでは id (ユーザのID)を integer で定義しているのに、commentテーブル(コメントを保存するテーブル)の user_id は integer(4) で定義されており、その間にrelationを張ろうとしているためエラーになっているようだ。</p>

<p>参考 : <a href="http://www.symfony-project.org/plugins/vjCommentPlugin" target="_blank">http://d.hatena.ne.jp/zankey/20070411/mysql</a></p>

<p>plugins/vjCommentPlugin/config/doctrine/schema.yml の comment テーブルの user_id の type を integer に変更して、再度 doctrine:build するとうまくいく。</p>

<hr />

<p><strong>海外の役立つブログ記事などを人力で翻訳して公開する<a href="https://yakst.com/ja">Yakst</a>というプロジェクトをやっています。よろしければそちらもどうぞ！</strong></p>

  </article>
  
  <article class="post">
    <h1 class="post-title">
      <a href="/dev/subversion%e3%83%aa%e3%83%9d%e3%82%b8%e3%83%88%e3%83%aa%e3%81%b8%e3%82%b3%e3%83%9f%e3%83%83%e3%83%88%e3%81%99%e3%82%8b%e3%81%a8%e3%81%8d%e3%81%ae405%e3%82%a8%e3%83%a9%e3%83%bc/">
        Subversionリポジトリへコミットするときの405エラー
      </a>
    </h1>

    <time datetime="2010-09-30T04:19:28-07:00" class="post-date">30 Sep 2010</time>

    <div class="wp_social_bookmarking_light">
  <div class="wsbl_hatena_button">
    <a href="http://b.hatena.ne.jp/entry/http://b.l0g.jp/dev/subversion%e3%83%aa%e3%83%9d%e3%82%b8%e3%83%88%e3%83%aa%e3%81%b8%e3%82%b3%e3%83%9f%e3%83%83%e3%83%88%e3%81%99%e3%82%8b%e3%81%a8%e3%81%8d%e3%81%ae405%e3%82%a8%e3%83%a9%e3%83%bc/" class="hatena-bookmark-button" data-hatena-bookmark-title="Subversionリポジトリへコミットするときの405エラー" data-hatena-bookmark-layout="standard" title="このエントリーをはてなブックマークに追加"> <img src="//b.hatena.ne.jp/images/entry-button/button-only@2x.png" alt="このエントリーをはてなブックマークに追加" width="20" height="20" style="border: none;" /></a>
  </div>
  
  <div class="wsbl_facebook_like">
    <div id="fb-root">
    </div><fb:like href="http://b.l0g.jp/dev/subversion%e3%83%aa%e3%83%9d%e3%82%b8%e3%83%88%e3%83%aa%e3%81%b8%e3%82%b3%e3%83%9f%e3%83%83%e3%83%88%e3%81%99%e3%82%8b%e3%81%a8%e3%81%8d%e3%81%ae405%e3%82%a8%e3%83%a9%e3%83%bc/" layout="button_count" action="like" width="100" share="false" show_faces="false"></fb:like>
  </div>
  
  <div class="wsbl_twitter">
    &lt;a href="https://twitter.com/share" class="twitter-share-button"{count} data-url="http://b.l0g.jp/dev/subversion%e3%83%aa%e3%83%9d%e3%82%b8%e3%83%88%e3%83%aa%e3%81%b8%e3%82%b3%e3%83%9f%e3%83%83%e3%83%88%e3%81%99%e3%82%8b%e3%81%a8%e3%81%8d%e3%81%ae405%e3%82%a8%e3%83%a9%e3%83%bc/" data-text="Subversionリポジトリへコミットするときの405エラー" data-via="dblmkt " data-lang="ja"&gt;Tweet
  </div>
  
  <div class="wsbl_google_plus_one">
    <g:plusone size="medium" annotation="none" href="http://b.l0g.jp/dev/subversion%e3%83%aa%e3%83%9d%e3%82%b8%e3%83%88%e3%83%aa%e3%81%b8%e3%82%b3%e3%83%9f%e3%83%83%e3%83%88%e3%81%99%e3%82%8b%e3%81%a8%e3%81%8d%e3%81%ae405%e3%82%a8%e3%83%a9%e3%83%bc/"></g:plusone>
  </div>
</div>

<p><br class="wp_social_bookmarking_light_clear" /></p>

<p>Subversionリポジトリへうまくコミットできないときがたまにあるので、メモ。</p>

<div>
</div>

<div id="_mcePaste">
  コミットしようとすると、途中で以下のようなエラーが出ることがあります。
</div>

<div id="_mcePaste">
</div>

<blockquote>
  <div>
  commit -m &#8220;あれこれ変更&#8221; -N (32 paths specified)
</div>

  <div id="_mcePaste">
  Sending        C:/Users/hoge/project/apps/frontend/modules/article/templates/indexSuccess.php
</div>

  <div id="_mcePaste">
  (中略)
</div>

  <div id="_mcePaste">
  Adding         C:/Users/hoge/project/cache/frontend/dev/template
</div>

  <div id="_mcePaste">
  RA layer request failed
</div>

  <div id="_mcePaste">
  svn: Commit failed (details follow):
</div>

  <div id="_mcePaste">
  svn: Server sent unexpected return value (405 Method Not Allowed) in response to MKCOL request for &#8216;/svn/pjtransrate/!svn/wrk/be91e174-dd4b-124f-abbd-dd57636aa9ad/trunk/cache/frontend/dev/template&#8217;
</div>

  <div id="_mcePaste">

</div>
</blockquote>

<div id="_mcePaste">
  <a href="http://pentan.info/program/tools/svn_commit_error.html" target="_blank">「405 Method Not Allowed」が出るときは、フォルダ名やファイル名にSubversionで管理できない文字が含まれている、との情報</a>があったりしますが、symfonyのcache/frontend/dev/templateの下は symfony cc した後は空なので、管理できない文字とやらが含まれているということはありません。
</div>

<div>
</div>

<div id="_mcePaste">
  とりあえずcache/frontend/dev/templateを手動で削除してからコミットしたら、うまくいきました。
</div>

<div id="_mcePaste">
</div>

<div>
  よく分かりませんが、うまくいったのでよしとしよう。
</div>

<hr />

<p><strong>海外の役立つブログ記事などを人力で翻訳して公開する<a href="https://yakst.com/ja">Yakst</a>というプロジェクトをやっています。よろしければそちらもどうぞ！</strong></p>

  </article>
  
  <article class="post">
    <h1 class="post-title">
      <a href="/uncategorized/windows-live-photo-gallery/">
        Windows付属のツールで簡単にパノラマ写真が作れる
      </a>
    </h1>

    <time datetime="2010-09-05T18:18:59-07:00" class="post-date">05 Sep 2010</time>

    <div class="wp_social_bookmarking_light">
  <div class="wsbl_hatena_button">
    <a href="http://b.hatena.ne.jp/entry/http://b.l0g.jp/uncategorized/windows-live-photo-gallery/" class="hatena-bookmark-button" data-hatena-bookmark-title="Windows付属のツールで簡単にパノラマ写真が作れる" data-hatena-bookmark-layout="standard" title="このエントリーをはてなブックマークに追加"> <img src="//b.hatena.ne.jp/images/entry-button/button-only@2x.png" alt="このエントリーをはてなブックマークに追加" width="20" height="20" style="border: none;" /></a>
  </div>
  
  <div class="wsbl_facebook_like">
    <div id="fb-root">
    </div><fb:like href="http://b.l0g.jp/uncategorized/windows-live-photo-gallery/" layout="button_count" action="like" width="100" share="false" show_faces="false"></fb:like>
  </div>
  
  <div class="wsbl_twitter">
    &lt;a href="https://twitter.com/share" class="twitter-share-button"{count} data-url="http://b.l0g.jp/uncategorized/windows-live-photo-gallery/" data-text="Windows付属のツールで簡単にパノラマ写真が作れる" data-via="dblmkt " data-lang="ja"&gt;Tweet
  </div>
  
  <div class="wsbl_google_plus_one">
    <g:plusone size="medium" annotation="none" href="http://b.l0g.jp/uncategorized/windows-live-photo-gallery/"></g:plusone>
  </div>
</div>

<p><br class="wp_social_bookmarking_light_clear" /></p>

<p>何だか広告みたいなタイトルになってしまったが、なかなかすごい機能だと思ったのでご紹介。</p>

<p>最近、Windows 7がインストールされたノートパソコン(Panasonic Let’s note S9)を衝動買いしてしまった。これには、Windows Liveフォトギャラリーというソフトが付属しており、デジカメで撮った写真などを管理することができる。SDカードからそのまま写真を取り込めるので、このソフトをそのまま使っている。別にPanasonicのPCにだけ付属しているソフトではなく、Windows 7には必ずインストールされているはず。</p>

<p><a href="http://b.l0g.jp/wp-content/uploads/2010/09/WS000000.jpg"><img class="alignnone size-medium wp-image-461" title="Windows Liveフォトギャラリー" src="http://b.l0g.jp/wp-content/uploads/WS000000-300x197.jpg" alt="" width="300" height="197" /></a></p>

<p>登山などで見晴らしの良いところへ行くと、360度ぐるっと写真を撮って、後でつなげて1枚にしたくなる。ところがなかなかこれを簡単にしかもきれいにできるソフトがなかったので、撮るだけ撮ってそのままにすることが多かった。しかし！このLiveフォトギャラリーでは、複数の写真を選択してメニューを選ぶだけで、簡単にパノラマ写真が作れる。</p>

<p><a href="http://b.l0g.jp/wp-content/uploads/2010/09/WS000001.jpg"><img class="alignnone size-medium wp-image-462" title="複数の写真を選ぶ" src="http://b.l0g.jp/wp-content/uploads/WS000001-300x197.jpg" alt="" width="300" height="197" /></a></p>

<p>[](http://b.l0g.jp/wp-content/uploads/2010/09/WS000001.jpg)パノラマ写真の一部となる写真を選ぶ。Ctrlキーを押しながら写真をクリックすると、上の画面のように背景が青になり、複数の写真を選択できる。</p>

<p><a href="http://b.l0g.jp/wp-content/uploads/2010/09/WS000002.jpg"><img class="alignnone size-medium wp-image-463" title="パノラマ写真を作成" src="http://b.l0g.jp/wp-content/uploads/WS000002-300x197.jpg" alt="" width="300" height="197" /></a></p>

<p>いずれかの写真の上で右クリックし、「パノラマ写真の作成」を選ぶ。</p>

<p><a href="http://b.l0g.jp/wp-content/uploads/2010/09/WS000003.jpg"><img class="alignnone size-medium wp-image-464" title="しばらく待つ" src="http://b.l0g.jp/wp-content/uploads/WS000003-300x148.jpg" alt="" width="300" height="148" /></a></p>

<p>作成にはそこそこ時間がかかる(手元の環境では、600万画素のデジタル一眼で撮った10枚をつなげるのに1分半ぐらい)。</p>

<p><a href="http://b.l0g.jp/wp-content/uploads/2010/09/WS000005.jpg"><img class="alignnone size-medium wp-image-465" title="パノラマ写真の出来上がり" src="http://b.l0g.jp/wp-content/uploads/WS000005-300x197.jpg" alt="" width="300" height="197" /></a></p>

<p>保存を促すダイアログが現れるので、ファイル名を指定して保存すると、出来上がったパノラマ写真が表示される。</p>

<p>今年8月上旬に飯豊連峰を縦走した時の、北股岳山頂からの眺めをパノラマ写真にしたのがこれ。</p>

<p><a href="http://b.l0g.jp/wp-content/uploads/2010/09/kitamata_panorama_s.jpg"><img class="alignnone size-medium wp-image-466" title="kitamata_panorama_s" src="http://b.l0g.jp/wp-content/uploads/kitamata_panorama_s-300x47.jpg" alt="" width="300" height="47" /></a></p>

<p>横幅が長すぎてうまく表示されない場合は、直接こちらから。かなりきれいにつながっている。</p>

<p><a href="http://b.l0g.jp/wp-content/uploads/2010/09/kitamata_panorama_s.jpg" target="_blank">http://b.l0g.jp/wp-content/uploads/2010/09/kitamata_panorama_s.jpg</a></p>

<p>ちなみに、北股岳山頂からの眺めは素晴らしかった。写真左側は頼母木小屋、杁差岳方面へ続く稜線。地図を見ている人(F西さん)の左側奥へ続く稜線が、それまで2日かけて歩いてきた飯豊連峰の主脈で、手前から梅花皮岳(かいらぎだけ)、烏帽子岳と続き、F西さんの右肩の上あたりが2日目に泊った御西小屋、左側に続く稜線上の最高点が飯豊本山、右側の人物の先が飯豊連峰の最高峰、大日岳だと思われる。鳥居の左奥辺りには佐渡が島が見えていたはず。ちょうど写真の境目の部分が二王子岳付近。</p>

<p>ああ、説明を書きながらまた行きたくなってきた。今度飯豊へ行くときは、6月ごろのまだ雪が豊富な時に行き、また真夏とは違った花々を楽しんでみたいものだ。</p>

<p>あ、結局ソフトの紹介じゃなくて、山に行きたいという話で終わってしまった。</p>

<hr />

<p><strong>海外の役立つブログ記事などを人力で翻訳して公開する<a href="https://yakst.com/ja">Yakst</a>というプロジェクトをやっています。よろしければそちらもどうぞ！</strong></p>

  </article>
  
</div>

<div class="pagination">
  
    <a class="pagination-item older" href="/page17">Older</a>
  
  
    <a class="pagination-item newer" href="/page15">Newer</a>
  
</div>

      </main>

      <footer class="footer">
        <small>
          &copy; <time datetime="2016-04-01T10:52:50-07:00">2016</time>. All rights reserved.
        </small>
      </footer>
    </div>

    
  </body>
</html>
