<!DOCTYPE html>
<html lang="en">

  <head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <title>
    
      Linuxがモノリシックカーネルである理由 &middot; 渋谷ではたらくインフラエンジニアのブログ
    
  </title>

  <link rel="stylesheet" href="/styles.css">
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/public/apple-touch-icon-precomposed.png">
  <link rel="shortcut icon" href="/public/favicon.ico">
  <link rel="alternate" type="application/atom+xml" title="渋谷ではたらくインフラエンジニアのブログ" href="/atom.xml">
</head>


  <body>

    <div class="container content">
      <header class="masthead">
        <h3 class="masthead-title">
          <a href="/" title="Home">渋谷ではたらくインフラエンジニアのブログ</a>
          <small></small>
        </h3>
      </header>

      <main>
        <article class="post">
  <h1 class="post-title">Linuxがモノリシックカーネルである理由</h1>
  <time datetime="2013-01-10T00:53:06-08:00" class="post-date">10 Jan 2013</time>
  <p>Quoraの問答は本当に面白いものばかり。技術的でないのもかなり興味深いものが多いが、またLinuxについてのネタで分かりやすいのがあったので訳してみた。</p>

<p><strong><a href="http://www.quora.com/Linux/What-is-meant-by-Linux-has-a-monolithic-kernel">Linuxがモノリシックカーネルであるというのはどういう意味か？</a></strong></p>

<p><strong>モノリシックカーネル</strong></p>

<p>モノリシックカーネルは、プロセスやメモリの管理、例外の取扱い、入出力のやり取り、ファイルシステムなどほとんどの基本的なシステムサービスを実行する。層構造になっており、基礎的なプロセス管理からOSの他の部分(ライブラリ群や、層の最上位であるアプリケーション)とのインタフェースからなっている。基本的なサービスをカーネルスペースに含めることは、次のような大きな3つの欠点となる。</p>

<ul>
  <li>カーネルサイズが大きくなる</li>
  <li>拡張性に乏しい</li>
  <li>メンテナンス性が悪い</li>
</ul>

<p><strong>マイクロカーネル</strong></p>

<p>カーネルの機能を基本的なプロセス間通信と入出力制御のみに絞り、ユーザスペースの他のシステムサービスを普通のプロセス(「サーバ」と呼ばれる)としてしまうのがコンセプトである。あるサーバはメモリに関する管理を行い、別のサーバはプロセス管理、さらに他のサーバはドライバの管理…といった具合だ。サーバはカーネルスペースでは実行されないので、ユーザプロセスが特権モードに入ったり出たりするためにいわゆるコンテキストスイッチが発生してしまう。この方式では、マイクロカーネルはもはやシステムサービスの塊ではなく、プロセス間通信とプロセスとその下のハードウェアとの通信を制御するための、単にいくつかの基本的な抽象化とプリミティブを提供するだけである。通信は直接行われないので、独立した通信と拡張性をもたらす、メッセージングの仕組みが使われる。</p>

<p>ここでLinuxカーネルの話に入ろう。Linuxカーネルは、モノリシックカーネルである。しかし、Linuxの美しいところは、どちらとしてもコンパイルできることである！</p>

<p>モノリシックカーネル</p>

<ul>
  <li>1つのバイナリファイル</li>
  <li>全ドライバがカーネル自体に含まれる</li>
</ul>

<p>モジュラーカーネル</p>

<ul>
  <li>複数のカーネルのファイル</li>
  <li>ドライバはmodprobeコマンドなどでカーネルにロードしたりアンロード可能。lsmodやmodprobeのmanページを参照</li>
  <li>ほとんど全てのドライバはカーネルに対してビルドされてリンクされる</li>
</ul>

<p>以下のカーネルコンフィグオプションの設定でモジュラーカーネルをビルドすることができる。</p>

<p>[text]</p>

<p>Enable loadable module support (CONFIG_MODULES) [Y/n/?]</p>

<p>[/text]</p>

<p>このオプションにYと答えるとモジュラーカーネルとなり、各機能やドライバそれぞれに関して3つの選択肢が現われる。</p>

<table class="article">
  <tr>
    <td>
      m
    </td>
    
    <td>
      ドライバをモジュールとしてコンパイルできる
    </td>
  </tr>
  
  <tr>
    <td>
      y
    </td>
    
    <td>
      カーネル自身に組み込む
    </td>
  </tr>
  
  <tr>
    <td>
      n
    </td>
    
    <td>
      機能・ドライバを含まない
    </td>
  </tr>
</table>

<p>(CONFIG_MODULES)オプションを n に設定した場合モノリシックカーネルとなり、各機能やドライバそれぞれに2つの選択肢がある。</p>

<table class="article">
  <tr>
    <td>
      y
    </td>
    
    <td>
      機能・ドライバを含む
    </td>
  </tr>
  
  <tr>
    <td>
      n
    </td>
    
    <td>
      機能・ドライバを含まない
    </td>
  </tr>
</table>

<p> </p>

<hr />

<p><strong>海外の役立つブログ記事などを人力で翻訳して公開する<a href="https://yakst.com/ja">Yakst</a>というプロジェクトをやっています。よろしければそちらもどうぞ！</strong></p>

</article>


<aside class="related">
  <h3>Related posts</h3>
  <ul class="related-posts">
    
      <li>
        <a href="/aws/periodic-ebs-snapshot/">
          AWSのEBSボリュームのスナップショットを定期的に取る
          <small><time datetime="2015-10-19T06:33:30-07:00">19 Oct 2015</time></small>
        </a>
      </li>
    
      <li>
        <a href="/misc/my-twitter-bots/">
          Twitterボットを作るのがひそかな趣味
          <small><time datetime="2015-05-22T06:26:26-07:00">22 May 2015</time></small>
        </a>
      </li>
    
      <li>
        <a href="/uncategorized/sql-performance-explained-ja/">
          「SQLパフォーマンス詳解」という本を翻訳しました
          <small><time datetime="2015-04-07T01:45:15-07:00">07 Apr 2015</time></small>
        </a>
      </li>
    
  </ul>
</aside>


      </main>

      <footer class="footer">
        <small>
          &copy; <time datetime="2016-04-01T11:15:44-07:00">2016</time>. All rights reserved.
        </small>
      </footer>
    </div>

    
  </body>
</html>
