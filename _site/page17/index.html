<!DOCTYPE html>
<html lang="en">

  <head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <title>
    
      渋谷ではたらくインフラエンジニアのブログ &middot; 
    
  </title>

  <link rel="stylesheet" href="/styles.css">
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/public/apple-touch-icon-precomposed.png">
  <link rel="shortcut icon" href="/public/favicon.ico">
  <link rel="alternate" type="application/atom+xml" title="渋谷ではたらくインフラエンジニアのブログ" href="/atom.xml">
</head>


  <body>

    <div class="container content">
      <header class="masthead">
        <h3 class="masthead-title">
          <a href="/" title="Home">渋谷ではたらくインフラエンジニアのブログ</a>
          <small></small>
        </h3>
      </header>

      <main>
        <div class="posts">
  
  <article class="post">
    <h1 class="post-title">
      <a href="/dev/symfony%e3%81%a7%e3%83%87%e3%83%bc%e3%82%bf%e3%82%92mysql%e3%81%ab%e3%83%ad%e3%83%bc%e3%83%89%e3%81%99%e3%82%8b%e9%9a%9b%e3%81%aeduplicate-entry%e3%82%a8%e3%83%a9%e3%83%bc/">
        symfonyでデータをMySQLにロードする際のduplicate entryエラー
      </a>
    </h1>

    <time datetime="2010-08-05T02:47:49-07:00" class="post-date">05 Aug 2010</time>

    <div class="wp_social_bookmarking_light">
  <div class="wsbl_hatena_button">
    <a href="http://b.hatena.ne.jp/entry/http://b.l0g.jp/dev/symfony%e3%81%a7%e3%83%87%e3%83%bc%e3%82%bf%e3%82%92mysql%e3%81%ab%e3%83%ad%e3%83%bc%e3%83%89%e3%81%99%e3%82%8b%e9%9a%9b%e3%81%aeduplicate-entry%e3%82%a8%e3%83%a9%e3%83%bc/" class="hatena-bookmark-button" data-hatena-bookmark-title="symfonyでデータをMySQLにロードする際のduplicate entryエラー" data-hatena-bookmark-layout="standard" title="このエントリーをはてなブックマークに追加"> <img src="//b.hatena.ne.jp/images/entry-button/button-only@2x.png" alt="このエントリーをはてなブックマークに追加" width="20" height="20" style="border: none;" /></a>
  </div>
  
  <div class="wsbl_facebook_like">
    <div id="fb-root">
    </div><fb:like href="http://b.l0g.jp/dev/symfony%e3%81%a7%e3%83%87%e3%83%bc%e3%82%bf%e3%82%92mysql%e3%81%ab%e3%83%ad%e3%83%bc%e3%83%89%e3%81%99%e3%82%8b%e9%9a%9b%e3%81%aeduplicate-entry%e3%82%a8%e3%83%a9%e3%83%bc/" layout="button_count" action="like" width="100" share="false" show_faces="false"></fb:like>
  </div>
  
  <div class="wsbl_twitter">
    &lt;a href="https://twitter.com/share" class="twitter-share-button"{count} data-url="http://b.l0g.jp/dev/symfony%e3%81%a7%e3%83%87%e3%83%bc%e3%82%bf%e3%82%92mysql%e3%81%ab%e3%83%ad%e3%83%bc%e3%83%89%e3%81%99%e3%82%8b%e9%9a%9b%e3%81%aeduplicate-entry%e3%82%a8%e3%83%a9%e3%83%bc/" data-text="symfonyでデータをMySQLにロードする際のduplicate entryエラー" data-via="dblmkt " data-lang="ja"&gt;Tweet
  </div>
  
  <div class="wsbl_google_plus_one">
    <g:plusone size="medium" annotation="none" href="http://b.l0g.jp/dev/symfony%e3%81%a7%e3%83%87%e3%83%bc%e3%82%bf%e3%82%92mysql%e3%81%ab%e3%83%ad%e3%83%bc%e3%83%89%e3%81%99%e3%82%8b%e9%9a%9b%e3%81%aeduplicate-entry%e3%82%a8%e3%83%a9%e3%83%bc/"></g:plusone>
  </div>
</div>

<p><br class="wp_social_bookmarking_light_clear" /></p>

<p>symfony 1.4.6 + XAMPP 1.7.3(Windows)で、ありがちなエラーではまったので、メモ。</p>

<div id="_mcePaste">
  symfonyのschema.ymlとfixture.ymlを記述して、
</div>

<blockquote>
  <div>
  # symfony doctrine:build &#8211;all &#8211;and-load &#8211;no-confirmation
</div>
</blockquote>

<div id="_mcePaste">
  で、一気にデータベースの再構築とデータのロードを行おうとしたところ、以下のエラー発生。
</div>

<blockquote>
  <div id="_mcePaste">
  &gt;&gt; doctrine  created tables successfully
</div>

  <div id="_mcePaste">
  &gt;&gt; doctrine  Loading data fixtures from &#8220;C:\&#8230;\Eclipse\symfony\data/fixtures&#8221;
</div>

  <div id="_mcePaste">
  &gt;&gt; doctrine  Loading data fixtures from &#8220;C:/&#8230;trineGuardPlugin/data/fixtures&#8221;
</div>

  <div id="_mcePaste">
  SQLSTATE[23000]: Integrity constraint violation: 1062 Duplicate entry &#8216;????&#8217; for key &#8216;name&#8217;
</div>
</blockquote>

<div id="_mcePaste">
  当たり前だが、fixture.ymlでは重複するような値を定義してはいない。????というのが気になるが、これは何？
</div>

<div id="_mcePaste">
  どうやらこれは、データベースの文字コードがlatin1などになっている場合に起きるようである。データベースの文字コードをUTF-8にすると共に、fixture.ymlに日本語のキーが含まれている場合、こちらの文字コードもUTF-8にする(Windowsではメモ帳などを使って編集すると普通Shift-JISになるので注意)。
</div>

<blockquote>
  <div id="_mcePaste">
  [mysqld]
</div>

  <div id="_mcePaste">
  default-character-set=utf8
</div>

  <div id="_mcePaste">
  character_set_server=utf8
</div>

  <div id="_mcePaste">
  skip-character-set-client-handshake
</div>

  <div id="_mcePaste">
  [mysql]
</div>

  <div id="_mcePaste">
  default-character-set=utf8
</div>
</blockquote>

<div id="_mcePaste">
  XAMPPのインストールフォルダ以下、mysql\bin\my.ini ファイル内の各項目に、上記を追記し、
</div>

<blockquote>
  <div id="_mcePaste">
  net stop mysql   # MySQLサービス停止
</div>

  <div id="_mcePaste">
  net start mysql  # MySQLサービス開始
</div>

  <div id="_mcePaste">
  mysql -uroot -p パスワード
</div>

  <div id="_mcePaste">
  mysql&gt; drop database データベース名;   # 念のためDB削除
</div>

  <div id="_mcePaste">
  mysql&gt; create database データベース名;   # 念のためDB再作成
</div>
</blockquote>

<div id="_mcePaste">
  としてMySQL再起動、データベース再作成をしてからもう一度
</div>

<blockquote>
  <div id="_mcePaste">
  # symfony doctrine:build &#8211;all &#8211;and-load &#8211;no-confirmation
</div>
</blockquote>

<div id="_mcePaste">
  とすれば、すんなりデータベースを作成できる。
</div>

<div id="_mcePaste">
  なお、自分がやったときには、MySQLのstatusコマンドではUTF-8になっていたのに、どうしても上記のDuplicate entryのエラーが出てしまい、混乱した。
</div>

<blockquote>
  <div id="_mcePaste">
  mysql  Ver 14.14 Distrib 5.1.41, for Win32 (ia32)
</div>

  <div id="_mcePaste">
  Connection id:          5
</div>

  <div id="_mcePaste">
  SSL:                    Not in use
</div>

  <div id="_mcePaste">
  Using delimiter:        ;
</div>

  <div id="_mcePaste">
  Server version:         5.1.41 Source distribution
</div>

  <div id="_mcePaste">
  Protocol version:       10
</div>

  <div id="_mcePaste">
  Connection:             Named pipe: MySQL
</div>

  <div id="_mcePaste">
  Client characterset:    UTF-8
</div>

  <div id="_mcePaste">
  Server characterset:    UTF-8
</div>

  <div id="_mcePaste">
  UNIX socket:            MySQL
</div>

  <div id="_mcePaste">
  Uptime:                 9 min 40 sec
</div>
</blockquote>

<div id="_mcePaste">
  この場合、以下のコマンドでも確認し、全部の設定がUTF-8に揃っているかを見てみるべし。
</div>

<blockquote>
  <div id="_mcePaste">
  mysql&gt; show variables like &#8216;char%&#8217;;
</div>

  <div id="_mcePaste">
  +&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8211;+&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;-+
</div>

  <div id="_mcePaste">
  | Variable_name            | Value                                  |
</div>

  <div id="_mcePaste">
  +&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8211;+&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;-+
</div>

  <div id="_mcePaste">
  | character_set_client     | utf8                                   |
</div>

  <div id="_mcePaste">
  | character_set_connection | utf8                                   |
</div>

  <div id="_mcePaste">
  | character_set_database   | utf8                                   |
</div>

  <div id="_mcePaste">
  | character_set_filesystem | binary                                 |
</div>

  <div id="_mcePaste">
  | character_set_results    | utf8                                   |
</div>

  <div id="_mcePaste">
  | character_set_server     | utf8                                   |
</div>

  <div id="_mcePaste">
  | character_set_system     | utf8                                   |
</div>

  <div id="_mcePaste">
  | character_sets_dir       | C:\eclipse\xampp\mysql\share\charsets\ |
</div>

  <div id="_mcePaste">
  +&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8211;+&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;-+
</div>

  <div id="_mcePaste">
  8 rows in set (0.00 sec)
</div>
</blockquote>

<div id="_mcePaste">
  どれかがlatin1などのままならば設定が不十分なので、もう一度my.iniを確認すること。
</div>

<hr />

<p><strong>海外の役立つブログ記事などを人力で翻訳して公開する<a href="https://yakst.com/ja">Yakst</a>というプロジェクトをやっています。よろしければそちらもどうぞ！</strong></p>

  </article>
  
  <article class="post">
    <h1 class="post-title">
      <a href="/reading/confessions-of-self-made-millionaires/">
        成功者の告白
      </a>
    </h1>

    <time datetime="2010-07-16T16:52:50-07:00" class="post-date">16 Jul 2010</time>

    <div class="wp_social_bookmarking_light">
  <div class="wsbl_hatena_button">
    <a href="http://b.hatena.ne.jp/entry/http://b.l0g.jp/reading/confessions-of-self-made-millionaires/" class="hatena-bookmark-button" data-hatena-bookmark-title="成功者の告白" data-hatena-bookmark-layout="standard" title="このエントリーをはてなブックマークに追加"> <img src="//b.hatena.ne.jp/images/entry-button/button-only@2x.png" alt="このエントリーをはてなブックマークに追加" width="20" height="20" style="border: none;" /></a>
  </div>
  
  <div class="wsbl_facebook_like">
    <div id="fb-root">
    </div><fb:like href="http://b.l0g.jp/reading/confessions-of-self-made-millionaires/" layout="button_count" action="like" width="100" share="false" show_faces="false"></fb:like>
  </div>
  
  <div class="wsbl_twitter">
    &lt;a href="https://twitter.com/share" class="twitter-share-button"{count} data-url="http://b.l0g.jp/reading/confessions-of-self-made-millionaires/" data-text="成功者の告白" data-via="dblmkt " data-lang="ja"&gt;Tweet
  </div>
  
  <div class="wsbl_google_plus_one">
    <g:plusone size="medium" annotation="none" href="http://b.l0g.jp/reading/confessions-of-self-made-millionaires/"></g:plusone>
  </div>
</div>

<p><br class="wp_social_bookmarking_light_clear" /></p>

<p>「5年間の起業ノウハウを3時間で学べる物語」と副題が付いているが、起業そのもの(事業を興すこと)ではなく、起業した後、事業が安定するまでの間にその企業が陥りやすい問題点を、小説形式で紹介している。巷では、日本では起業が少ないとか、起業しようとかするなとか、色々な話が流れているが、起業した後どうしたらいいのかという点について書かれた本は少ないように思う(実際自分がそういうステージに達していないから気づかないだけかもしれないが)。</p>

<p>特にこの本では、直接にビジネスに関係することというより、人間関係を中心に、しかも会社内だけに限らず人生の中で起業がどういう影響を及ぼしていくのかについて言及しており、なかなか面白い。内容は、エピローグにまとめてあるとおり。</p>

<ol>
  <li>成功に向かって一歩を踏み出す。仕事は辛いが家庭は円満</li>
  <li>成功に向かって離陸。仕事は好調、家庭で歪みが出始める</li>
  <li>成功への分かれ目。仕事は好調、人間関係で問題勃発。家庭はあきらめムード</li>
  <li>仕事と家庭のバランス回復。仕事では人を指導する立場に、家庭では相互依存へ</li>
</ol>

<p>本文では、この過程を多少大げさに時系列で描いている。起業した人、したい人だけでなく、自分の会社がどのステージにいるのか客観的に見るいい機会にもなるので、一般企業に勤める人にも役に立つだろう。</p>

<p>本文は前述の通り面白いのだが、読み進めるほど、起業の困難にブチ当たるどころか、事業を興すことが何かも体験していない自分が歯がゆい。</p>

<hr />

<p><strong>海外の役立つブログ記事などを人力で翻訳して公開する<a href="https://yakst.com/ja">Yakst</a>というプロジェクトをやっています。よろしければそちらもどうぞ！</strong></p>

  </article>
  
  <article class="post">
    <h1 class="post-title">
      <a href="/android/mytracksintro/">
        登山記録に使えるGPSアプリ My Tracks
      </a>
    </h1>

    <time datetime="2010-07-06T17:42:17-07:00" class="post-date">06 Jul 2010</time>

    <div class="wp_social_bookmarking_light">
  <div class="wsbl_hatena_button">
    <a href="http://b.hatena.ne.jp/entry/http://b.l0g.jp/android/mytracksintro/" class="hatena-bookmark-button" data-hatena-bookmark-title="登山記録に使えるGPSアプリ My Tracks" data-hatena-bookmark-layout="standard" title="このエントリーをはてなブックマークに追加"> <img src="//b.hatena.ne.jp/images/entry-button/button-only@2x.png" alt="このエントリーをはてなブックマークに追加" width="20" height="20" style="border: none;" /></a>
  </div>
  
  <div class="wsbl_facebook_like">
    <div id="fb-root">
    </div><fb:like href="http://b.l0g.jp/android/mytracksintro/" layout="button_count" action="like" width="100" share="false" show_faces="false"></fb:like>
  </div>
  
  <div class="wsbl_twitter">
    &lt;a href="https://twitter.com/share" class="twitter-share-button"{count} data-url="http://b.l0g.jp/android/mytracksintro/" data-text="登山記録に使えるGPSアプリ My Tracks" data-via="dblmkt " data-lang="ja"&gt;Tweet
  </div>
  
  <div class="wsbl_google_plus_one">
    <g:plusone size="medium" annotation="none" href="http://b.l0g.jp/android/mytracksintro/"></g:plusone>
  </div>
</div>

<p><br class="wp_social_bookmarking_light_clear" /></p>

<p>自分がAndroid携帯(Sony ErricsonのXperia)を買ったのは、スマートフォンならではの自由度の高さ(画面の大きさやセンサーの多さなど)を活かしたアプリケーションを、自分で作って使ってみたいと思ったことがきっかけである。スマートフォンといえばiPhoneじゃない？という人が多いと思うが、登山によく行く自分にとって、少なくとも現時点ではドコモとauと比較するとかなり電波状況の悪いソフトバンクテレコムに乗り換えるという選択肢はどうしても取れなかった。また、iPhoneアプリを作るには、まずMacを買わなければならないというのも、Android携帯を選んだ理由である。現時点で、良好な電波状況と端末の完成度の両方を満たす端末は、Xperia以外にないといえる(auのIS01もありという人もいるかもしれないが)。と思っているのだが、なぜか自分の登山仲間のスマフォ持ちはiPhoneばっかり。へっ！iPhoneなんてソフバンで電波届かないから、どうせ山に登って「山頂なう！」ってつぶやきもできないくせに！(笑)</p>

<p>具体的に作ってみたかったアプリとしては、登山道を歩きながらGPSデータを保存してくれる、GPSロガーである。ところが、Xperiaを入手してあれこれと初歩的なアプリを作っているうちに、My Trackというアプリを見つけた。</p>

<p><a href="http://mytracks.appspot.com/">My Tracks for Android</a></p>

<p>これはまさに欲しかったアプリではないか！ 事前に調べた限りではGPSロガー的なアプリは見つからなかったのだが(iPhoneアプリはいくつか見つけた)、探し方が悪かっただけらしい。そんなわけで、自分で作らなくても既にあったので、あっさりと自分のAndroidアプリ制作意欲はほぼゼロまで削がれた。2010年5月からはソースコードも公開されたため、改変も可能になった。</p>

<p><a href="http://code.google.com/p/mytracks/">mytracks – Project Hosting on Google Code</a></p>

<p>使い方は簡単で、Record Trackというメニューを選んで歩き始めると、一定の間隔でGPSの情報を記録し、Googleマップ上に表示してくれるというのが基本機能。以下の画面は乾徳山に登った時のコースの一部。機種や電波の受信状況にもよるだろうが、結構高精度で記録が取れる。この時はRecord Trackするのを忘れていて、一部のルートしか記録できなかった。</p>

<p><a href="http://b.l0g.jp/wp-content/uploads/2010/07/01.png"><img src="http://b.l0g.jp/wp-content/uploads/01-168x300.png" alt="" title="01" width="168" height="300" class="alignnone size-medium wp-image-394" /></a></p>

<p>Stop Recordメニューを選べば、記録終了。Googleマップでは、拡大すると等高線も表示されるので、地形なども推測できる。</p>

<p><a href="http://b.l0g.jp/wp-content/uploads/2010/07/02.png"><img src="http://b.l0g.jp/wp-content/uploads/02-168x300.png" alt="" title="02" width="168" height="300" class="alignnone size-medium wp-image-395" /></a></p>

<p>画面中央左右の矢印をタップすると、他の情報も見られる。右をタップすると、歩いた距離や最高・平均速度、最低・最高標高、標高差などが確認できる。</p>

<p><a href="http://b.l0g.jp/wp-content/uploads/2010/07/03.png"><img src="http://b.l0g.jp/wp-content/uploads/03-168x300.png" alt="" title="03" width="168" height="300" class="alignnone size-medium wp-image-396" /></a></p>

<p>さらに右をタップすると、横軸に距離、縦軸に標高と歩行速度のグラフが見られる。緑が標高で、この時は1.5kmほど歩く間に1580mぐらいから1800m近くまで登った様子がわかる。青が歩行速度で、見方は…単位がいまいちよくわからない。</p>

<p><a href="http://b.l0g.jp/wp-content/uploads/2010/07/04.png"><img src="http://b.l0g.jp/wp-content/uploads/04-168x300.png" alt="" title="04" width="168" height="300" class="alignnone size-medium wp-image-397" /></a></p>

<p>もちろんGPSのトラックデータはPCにコピーすることができる。そのデータをGoogle Earthやカシミール3Dに重ねあわせてみるとまた面白いだろう。</p>

<p>このアプリ自体は、なにも登山にだけ用途が限られているわけではなく、ウォーキングやジョギングの際などにも色々使い道が考えられる。日本語化はされていないようだが、「Android携帯を持っていて登山やウォーキングをする」という人は日本にはまだまだ少ないだろうから、そんなものかもしれない。オープンソースなので自分で翻訳してもいいのだが、まずは機能が分かっていないので、もう少しあちこちの山に行く時に使ってみようと思っている。</p>

<hr />

<p><strong>海外の役立つブログ記事などを人力で翻訳して公開する<a href="https://yakst.com/ja">Yakst</a>というプロジェクトをやっています。よろしければそちらもどうぞ！</strong></p>

  </article>
  
</div>

<div class="pagination">
  
    <a class="pagination-item older" href="/page18">Older</a>
  
  
    <a class="pagination-item newer" href="/page16">Newer</a>
  
</div>

      </main>

      <footer class="footer">
        <small>
          &copy; <time datetime="2016-04-01T10:52:50-07:00">2016</time>. All rights reserved.
        </small>
      </footer>
    </div>

    
  </body>
</html>
